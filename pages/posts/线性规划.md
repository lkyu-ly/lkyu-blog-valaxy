---
title: 数学建模笔记——线性规划
author: lkyu
tags:
  - 笔记
  - 数学建模
  - python
categories:
  - 笔记
date: 2023-7-17
updated: 2023-7-21
description:
---

## 1.1 线性规划模型

### 运用 python 进行矩阵的运算

```python
import numpy as np

a = np.array([[1, 2, 3], [4, 5, 6]])
b = np.array([[1, 2], [3, 4], [5, 6]])
c = np.array([[1, 2, 3]])
d = np.array([[9, 8, 7], [3, 2, 1]])
# 矩阵加法
sum = a + d
# 放缩
e = 3*a
# 数乘、矩阵乘
e = np.dot(a, b)
# 元素乘
e = a*d
# 转置
e = c.T
e = np.array([[1, 2], [3, 4]])
# 逆矩阵
result = np.linalg.inv(e)
# 行列式
result = np.linalg.det(e)
# 矩阵的秩
e = np.linalg.matrix_rank(d)
```

### 运用 python 求一次方程组的解

主要通过`scipy` `sympy` `numpy`这三个库就能实现各种各样的一次方程组求解。`sympy`主要用于符号解，`numpy`和`scipy`主要用于数值解。

例：

$$
f(x)=\begin{cases}
10x-y-2z =72\\
-x +10y -2z =83\\
-x-y+5z=42
\end{cases}
$$

解：

```python
import numpy as np
from sympy import Eq, solve, symbols

A = np.array([[10, -1, -2], [-1, 10, -2], [-1, -1, 5]])  # A为系数矩阵
b = np.array([72, 83, 42])  # b为常数列
inv_A = np.linalg.inv(A)  # A的逆矩阵
x = inv_A.dot(b)  # A的逆矩阵与b做点积运算
x = np.linalg.solve(A, b)  # 5,6两行也可以用本行替代
print(x)

x, y, z = symbols('x y z')
eqs = [Eq(10*x - y - 2*z, 72),
       Eq(-x + 10*y - 2*z, 83),
       Eq(-x - y + 5*z, 42)]
print(solve(eqs, [x, y, z]))
```

输出：

```text
[11. 12. 13.]
{x: 11, y: 12, z: 13}
```

### 线性规划的矩阵形式

- 不等式组条件的矩阵化
- 方程组条件的矩阵化
- 每个变量自己的取值范围
- 目标函数的向量化
- 求极值

目标函数是决策变量的线性组合，有不等关系，等量关系，变量范围，求目标极小值

标准形式 1（规范式、编程使用）：

$$
\begin{gather*}
\begin{align*}
&\ minC^TX &目标函数 \\
&\ \ \ X
\end{align*}  \\
s.t.\begin{cases}
Ax\leq b &不等式组约束条件 \\
Aeq·x=beq &方程组 \\
lb\leq x\leq ub &自变量取值范围
\end{cases}
\end{gather*}
$$

> 要点：**决策变量`X`，目标函数，约束条件**

标准形式 2：

$$
\begin{gather*}
\begin{align*}
&\ min \ z=C^TX &目标函数 \\
\end{align*}  \\
s.t.\begin{cases}
A\tilde{x}=b \\
\tilde{x}\geq 0
\end{cases}
\end{gather*}
$$

> **如何理解线性规划的标准形式**
>
> - 问题是线性的极大值/极小值
> - 约束条件本应该是小于等于，这是通用，改等于是利用线性
> - 存在不等约束时变换可应用松弛变量
> - 规划问题的核心在于决策变量，目标函数和约束条件

### 线性规划的 python 指令求解

例题：

$$
\begin{align*}
&\ max\ z=2x_1+3x_2-5x_3\\
&\ st.\begin{cases}
x_1+x_2+x_3=7\\
2x_1-5x_2+x_3\geq 10\\
x_1+3x_2+x_3\leq 12\\
x_1,x_2,x_3\geq 0\\
\end{cases}
\end{align*}
$$

求解代码：

```python
import numpy as np
from scipy.optimize import linprog

c = np.array([-2, -3, 5]) #目标函数
Aeq = np.array([[1, 1, 1]]) #方程组
beq = np.array([7]) #方程组
A = np.array([[-2, 5, -1], [1, 3, 1]]) #不等式组约束条件
b = np.array([-10, 12]) #不等式组约束条件
x1, x2, x3 = (0, None), (0, None), (0, None) #表示0到无穷大

res = linprog(c, A, b, Aeq, beq, bounds=(x1, x2, x3)) #调用
print(res)
```

### 单纯形法

回顾中学阶段，我们求线性规划的时候都是解方程然后直接带点进去，直线与直线之间两两相交就有交点，这其实就是单纯形法的雏形。现在的线性规划方程组是**不一定**存在交点或者不唯一解的。

线性代数中我们会知道：解方程组的时候是可以用**向量和基分解的思想**眼解决的。**单纯形法**的思想就是：固定变量，不断变换基向求方程组的解带入，看是不是最优解，不是就更新迭代现阶段的解。

## 1.2 非线性规划模型

### 非线性问题相比于线性问题

在线性规划的基础上，目标函数可以非线性，限制条件可以非线性，包括非线性的不等式和非线性的等式。

$$
\begin{align*}
&\ \quad min \ f(x)\\
&\ \begin{cases}
Ax\leq b \\
Aeq\cdot x= Beq\\
c(x)\leq 0\\
Ceq(x)=0\\
\end{cases}
\end{align*}
$$
